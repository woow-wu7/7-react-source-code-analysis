import React, { createContext, useRef, useCallback, useContext } from "react";

// Most things that we auto-id aren't server rendered, and are rendered into
// portals anyway, so we can get away with random ids in a default context. If
// people need to server render with auto-ids, they can wrap their app in an
// IdProvider
var genId = function genId() {
  return Math.random().toString(32).substring(2);
};

var IdContext = createContext(genId);

export var IdProvider = function IdProvider(_ref) {
  var children = _ref.children;

  var ref = useRef(0);
  // could use UUID but if we hit 9,007,199,254,740,991 unique components over
  // the lifetime of the app before it gets reloaded, I mean ... come on.
  // I don't even know what xillion that is.
  // /me googles
  // Oh duh, quadrillion. Nine quadrillion components. I think we're okay.
  var genId = useCallback(function () {
    return ++ref.current;
  }, []);
  return React.createElement(IdContext.Provider, { value: genId, children: children });
};

export var useId = function useId() {
  var genId = useContext(IdProvider);
  var ref = useRef(genId());
  return ref.current;
};